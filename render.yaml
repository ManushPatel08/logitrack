services:
  # Backend API Service
  - type: web
    name: logitrack-api-manush
    runtime: docker
    repo: https://github.com/ManushPatel08/logitrack
    branch: main
    rootDir: backend
    dockerfilePath: ./Dockerfile
    region: oregon
    plan: free
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: POSTGRES_USER
        sync: false
      - key: POSTGRES_PASSWORD
        sync: false
      - key: POSTGRES_DB
        sync: false
      - key: POSTGRES_HOST
        sync: false

  # Worker Background Service
  - type: worker
    name: logitrack-worker-manush
    runtime: docker
    repo: https://github.com/ManushPatel08/logitrack
    branch: main
    rootDir: worker
    dockerfilePath: ./Dockerfile
    region: oregon
    plan: free
    envVars:
      - key: DATABASE_URL
        sync: false
      - key: HF_API_KEY
        sync: false
      - key: AISSTREAM_API_KEY
        sync: false
      - key: AISSTREAM_WS_API_KEY
        sync: false
      - key: USE_AIS_API
        value: false
      - key: DISABLE_MOCK_INGEST
        value: false
      - key: AISSTREAM_MODE
        value: ws
      - key: AISSTREAM_WS_URL
        value: wss://stream.aisstream.io/v0/stream
      - key: AISSTREAM_WS_BOUNDING_BOXES
        value: "[[[-90,-180],[90,180]]]"
      - key: AISSTREAM_WS_RECEIVE_SECONDS
        value: "120"
      - key: AISSTREAM_POLL_INTERVAL_SECONDS
        value: "60"
      - key: MOCK_EVENT_INTERVAL_SECONDS
        value: "5"
      - key: AI_MAX_PER_CYCLE
        value: "3"
      - key: AI_FALLBACK_HEURISTICS
        value: "true"
      - key: AI_HEURISTIC_ON_INSERT
        value: "true"
      - key: AI_BACKFILL_HEURISTICS_ON_START
        value: "true"
      - key: AI_BACKFILL_LIMIT
        value: "1000"
